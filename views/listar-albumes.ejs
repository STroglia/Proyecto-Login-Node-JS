<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <title>Editar y Eliminar Álbumes - Mar de Música</title>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }

    /* Estilos personalizados */
    .form-container {
      max-width: 800px; /* Define el ancho máximo del formulario */
      margin: 0 auto; /* Centra el formulario */
    }

    .btn-primary {
      background-color: #FF7F50; /* Naranja coral */
      border-color: #FF7F50;
    }

    .btn-primary:hover {
      background-color: #FF6347; /* Tomate */
      border-color: #FF6347;
    }

    .btn-secondary {
      background-color: #D3D3D3; /* Gris claro */
      border-color: #D3D3D3;
    }

    h2, h3 {
      color: #FF4500; /* Naranja oscuro */
    }

    .border {
      border-color: #D3D3D3 !important; /* Bordes en gris claro */
    }

    .list-group-item {
      background-color: #f8f9fa;
    }

    .list-group-item:hover {
      background-color: #f1f3f5; /* Gris claro al pasar el mouse */
    }

    .btn-danger {
      background-color: #FF6347; /* Tomate */
      border-color: #FF6347;
    }

    .btn-danger:hover {
      background-color: #FF4500; /* Naranja oscuro */
      border-color: #FF4500;
    }
  </style>
  <link href="css/dashboard.css" rel="stylesheet">
</head>

<body>
  <!-- Navbar -->
  <header class="navbar navbar-dark sticky-top bg-secondary flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">Mar de Música</a>
    <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar-nav">
      <div class="nav-item text-nowrap">
        <a type="button" class="px-3 py-1 fs-5 badge bg-secondary" href="logout">Logout</a>
      </div>
    </div>
  </header>

  <!-- Botón de regreso a la página de inicio -->
  <main class="container mt-4">
    <div class="mb-3">
      <a href="/" class="btn btn-secondary">Volver a Inicio</a>
    </div>

    <!-- Lista de álbumes -->
    <div class="mb-4 p-3 border rounded shadow-sm form-container">
      <h2 class="text-center">Lista de Álbumes</h2>
      <ul class="list-group">
        <% albumes.forEach(album => { %>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span><strong><%= album.nombre %></strong> - <%= album.artista %></span>
            <button class="btn btn-primary btn-sm" onclick="mostrarFormularioEdicion(<%= album.id %>, '<%= album.nombre %>', '<%= album.artista %>', '<%= album.fecha_lanzamiento %>', '<%= album.archivo_album %>')">Editar</button>
          </li>
        <% }) %>
      </ul>
    </div>

    <!-- Formulario de edición de álbumes -->
    <div id="formularioEdicion" style="display: none;" class="mb-4 p-3 border rounded shadow-sm form-container">
      <h3 class="text-center">Editar Álbum</h3>
      <form id="editarAlbumForm" action="/editar-album" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="id" id="albumId">
        
        <div class="form-group mb-3">
          <label for="nombre" class="form-label">Nombre del álbum:</label>
          <input type="text" name="nombre" id="nombre" class="form-control" required>
        </div>

        <div class="form-group mb-3">
          <label for="artista" class="form-label">Artista:</label>
          <input type="text" name="artista" id="artista" class="form-control" required>
        </div>

        <div class="form-group mb-3">
          <label for="fecha_lanzamiento" class="form-label">Fecha de lanzamiento:</label>
          <input type="date" name="fecha_lanzamiento" id="fechaLanzamiento" class="form-control" required>
        </div>

        <div class="form-group mb-3">
          <label for="archivo_album" class="form-label">Archivo álbum:</label>
          <input type="file" name="archivo_album" id="archivoAlbum" class="form-control" accept=".mp3,.wav" required>
        </div>

        <div class="form-group mb-3">
          <label for="archivo_foto" class="form-label">Cambiar foto del álbum:</label>
          <input type="file" name="archivo_foto" id="archivoFoto" class="form-control" accept=".jpg,.jpeg,.png">
        </div>

        <button type="submit" class="btn btn-primary w-100">Actualizar Álbum</button>
      </form>
    </div>

    <!-- Formulario de eliminación de álbumes -->
    <div class="mb-4 p-3 border rounded shadow-sm form-container">
      <h3 class="text-center text-danger">Eliminar Álbum</h3>
      <form action="/eliminar-album" method="POST" onsubmit="return confirm('¿Estás seguro de querer eliminar este álbum?');">
        <div class="form-group mb-3">
          <label for="albumEliminar" class="form-label">Selecciona un álbum para eliminar:</label>
          <select name="id" id="albumEliminar" class="form-select">
            <option value="">Seleccione un álbum</option>
            <% albumes.forEach(album => { %>
              <option value="<%= album.id %>"><%= album.nombre %> - <%= album.artista %></option>
            <% }) %>
          </select>
        </div>
        <button type="submit" class="btn btn-danger w-100">Eliminar Álbum</button>
      </form>
    </div>
  </main>

  <!-- Scripts -->
  <script>
    function mostrarFormularioEdicion(id, nombre, artista, fechaLanzamiento, archivoAlbum) {
      document.getElementById('albumId').value = id;
      document.getElementById('nombre').value = nombre;
      document.getElementById('artista').value = artista;
      document.getElementById('fechaLanzamiento').value = fechaLanzamiento;
      document.getElementById('archivoAlbum').value = '';
      document.getElementById('archivoFoto').value = '';

      // Mostrar el formulario de edición
      document.getElementById('formularioEdicion').style.display = 'block';
    }
  </script>

  <script src="js/bootstrap.bundle.min.js"></script>
</body>
</html>
